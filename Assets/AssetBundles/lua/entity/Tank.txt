local Entity = require "entity/Entity"
local Tank = Class(Entity)
local inspect = require("core/inspect")

function Tank:Init(monoComponent, gameObject)
    self.gameObject = gameObject
	self.monoComponent = monoComponent
    self.transform = gameObject.transform
    self.tankBodyObj = self.transform:Find("Body")

    self.firePosTr = self.transform:Find("Body/Gun/FirePos").transform
    self.dir = Vector3.up

end

function Tank:MoveTo(toPos)
    local currPos = self.transform.position
    local dir = (toPos - currPos).normalized

    local r = Quaternion.FromToRotation(Vector3(1,0,0), dir)
    self.tankBodyObj.transform.rotation = r

    self.dir = dir

end

function Tank:Shoot()
	
    local go = ResourceMgr.CreateInstance("AssetBundles/prefabs/Bullet")
    go.transform.position = self.firePosTr.position
    go.transform.rotation = Quaternion.identity
    go.transform.localScale = Vector3.one

    local bullet = go:GetComponent(LuaComponent):GetLuaObject()
    bullet.dir = self.dir
end

return Tank